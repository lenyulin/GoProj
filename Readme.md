系统架构与功能设计说明



一、整体架构设计



采用 Go 语言构建基于 grpc + protobuf 的微服务架构系统，运用 DDD（领域驱动设计）及 TDD（测试驱动开发）设计方法，遵循面向接口与依赖注入模式开发。借助 viper + etcd 进行配置加载，依托微服务治理策略，搭配 Zap（日志组件 ）、Prometheus（监控组件 ）等，保障系统高可用、高并发与弹性扩展能力，支撑用户管理、评论、视频管理、互动四大核心功能，同时提升系统可观测性。


二、各模块功能设计



### （一）用户管理&#xA;



*   采用 JWT 实现用户权限管理，利用 Lua + Redis 滑动窗口限流防护系统，抵御恶意请求。


*   设计带验证码有效期控制的短信登录方案，以 Lua 脚本解决并发场景下的资源竞争等问题。


*   通过多级熔断降级策略，在系统压力过大或依赖服务异常时，保障核心功能高可用性。


### （二）评论 & 互动&#xA;



*   基于 MySQL + Redis 多级缓存架构（L1 本地缓存 + L2 分布式缓存 ），结合一致性哈希负载均衡，提升缓存命中率，实现一级 / 二级评论快速加载，优化用户访问体验。


*   借助 Kafka 异步处理 + 批量消费策略，对评论、互动等流量进行削峰，保障系统稳定运行。


### （三）视频管理&#xA;



*   实现视频发布、搜索等核心功能，通过定时任务计算热门榜单。


*   采用腾讯云 OSS 存储视频，结合异步 TCC 模式优化上传流程（待优化 ），提升系统处理效率与稳定性。作为微抖音（wedy）的子系统，实现秒杀商城系统功能，整体技术架构与微抖音保持一致。


### （四）Web 网管层及相关优化&#xA;



*   在 Web 网管层实现请求前置过滤，拦截未授权用户及无效活动请求，降低后端服务负载。


*   自行封装 HybridCache（BigCache + Redis ）缓存架构，提升活动信息访问效率；通过 Canal + Kafka 实现缓存秒级同步，采用乐观锁保障分布式数据一致性。


*   结合异步 TCC 事务模式处理订单、库存与优惠券扣减，缩短核心接口响应时间，提升系统吞吐量。


*   利用 Kafka 实现 TCC 事务的持久化储存，通过延迟消费机制，实现超时自动查询订单状态并执行超时取消功能 。


> （注：文档部分内容可能由 AI 生成）
>